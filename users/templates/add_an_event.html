{% extends 'user_base.html' %}
{% load static %}

{% block title %}Add New Event{% endblock %}

{% block content %}
<main class="max-w-3xl mx-auto py-8 sm:px-6 lg:px-8">
    <div class="bg-white p-6 sm:p-8 rounded-xl shadow-xl border border-gray-100">
        <div class="mb-8 text-center">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">Create a New Event</h1>
            <p class="text-gray-500 mt-2">Fill in the details below to get your event set up.</p>
        </div>

        <form method="POST" action="" class="space-y-6" enctype="multipart/form-data"> {% csrf_token %}

            <div>
                <label for="event_name" class="block text-sm font-medium text-gray-700 mb-1">Event Name <span class="text-red-500">*</span></label>
                <input type="text" name="event_name" id="event_name" required
                       class="w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200"
                       placeholder="e.g., Annual Tech Conference">
            </div>

            <div>
                <label for="event_category" class="block text-sm font-medium text-gray-700 mb-1">Event Category <span class="text-red-500">*</span></label>
                <select id="event_category" name="event_category" required
                        class="w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 bg-white">
                    <option value="" disabled selected>Select a category</option>
                    {% for category in categories %} <option value="{{ category.id }}">{{ category.name }}</option>
                    {% empty %}
                        <option value="general">General</option> <option value="conference">Conference</option>
                        <option value="workshop">Workshop</option>
                        <option value="meetup">Meetup</option>
                        <option value="webinar">Webinar</option>
                        <option value="social">Social Gathering</option>
                        <option value="sports">Sports</option>
                        <option value="other">Other</option>
                    {% endfor %}
                </select>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                <div>
                    <label for="event_date" class="block text-sm font-medium text-gray-700 mb-1">Date <span class="text-red-500">*</span></label>
                    <input type="date" name="event_date" id="event_date" required
                           class="w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200"
                           min="{% now 'Y-m-d' %}"> {# Prevent selecting past dates #}
                </div>
                <div>
                    <label for="event_time" class="block text-sm font-medium text-gray-700 mb-1">Time <span class="text-red-500">*</span></label>
                    <input type="time" name="event_time" id="event_time" required
                           class="w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200">
                </div>
            </div>

            <div>
                <label for="event_location" class="block text-sm font-medium text-gray-700 mb-1">Location <span class="text-red-500">*</span></label>
                <input type="text" name="event_location" id="event_location" required
                       class="w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200"
                       placeholder="e.g., 123 Main St, Anytown or Online">
            </div>

            <div>
                <label for="event_description" class="block text-sm font-medium text-gray-700 mb-1">Description <span class="text-red-500">*</span></label>
                <textarea id="event_description" name="event_description" rows="5" required
                          class="w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200"
                          placeholder="Provide a detailed description of your event..."></textarea>
            </div>

            <div>
                <label for="event_image_url" class="block text-sm font-medium text-gray-700 mb-1">Event Image URL (Optional)</label>
                <input type="url" name="event_image_url" id="event_image_url"
                       class="w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200"
                       placeholder="https://example.com/image.jpg">
                <p class="mt-1 text-xs text-gray-500">Link to an image for your event (e.g., banner, logo).</p>
            </div>
            
            <div>
                <label for="max_attendees" class="block text-sm font-medium text-gray-700 mb-1">Maximum Attendees (Optional)</label>
                <input type="number" name="max_attendees" id="max_attendees" min="1"
                       class="w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200"
                       placeholder="e.g., 100 (leave blank for unlimited)">
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Visibility <span class="text-red-500">*</span></label>
                <div class="flex items-center space-x-6">
                    <div class="flex items-center">
                        <input id="visibility_public" name="event_visibility" type="radio" value="public" required checked
                               class="focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300">
                        <label for="visibility_public" class="ml-2 block text-sm text-gray-900">
                            Public (Visible to everyone)
                        </label>
                    </div>
                    <div class="flex items-center">
                        <input id="visibility_private" name="event_visibility" type="radio" value="private" required
                               class="focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300">
                        <label for="visibility_private" class="ml-2 block text-sm text-gray-900">
                            Private (Only visible via direct link/invite)
                        </label>
                    </div>
                </div>
            </div>
            
            <div>
                <label for="event_tags" class="block text-sm font-medium text-gray-700 mb-1">Tags (Optional)</label>
                <input type="text" name="event_tags" id="event_tags"
                       class="w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200"
                       placeholder="e.g., tech, networking, startup (comma-separated)">
                <p class="mt-1 text-xs text-gray-500">Help people find your event. Separate tags with commas.</p>
            </div>


            <div class="pt-4">
                <button type="submit"
                        class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200">
                    Create Event
                </button>
            </div>
        </form>
    </div>
</main>

<script>
    // Optional: JavaScript for date/time validation or dynamic interactions
    document.addEventListener('DOMContentLoaded', function() {
        const dateInput = document.getElementById('event_date');
        const timeInput = document.getElementById('event_time');

        // Set minimum date to today
        const today = new Date().toISOString().split('T')[0];
        if(dateInput) {
            dateInput.setAttribute('min', today);
        }

        // Basic future time validation if date is today
        if(dateInput && timeInput) {
            dateInput.addEventListener('change', validateTime);
            timeInput.addEventListener('change', validateTime);
        }

        function validateTime() {
            const selectedDate = dateInput.value;
            const selectedTime = timeInput.value;

            if (selectedDate === today && selectedTime) {
                const now = new Date();
                const currentTime = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
                if (selectedTime < currentTime) {
                    alert("For today's events, please select a future time.");
                    timeInput.value = ''; // Reset time
                }
            }
        }
    });
</script>

{% endblock %}
